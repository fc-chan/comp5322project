import{r as I}from"./request-BCwGN2Wi.js";import{u as x}from"./user-DS6fjr0c.js";import{y as P,z as N,r as B,h as q,f as t,w as o,b as a,d as T,e as i,g as m,E as _,_ as H}from"./index-lND25TUq.js";const K={class:"auction-container"},O={class:"date-row"},j={class:"submit-row"},A=P({__name:"CreateItem",setup(M){const f=x(),V=f.user.token,l=N({sellerId:f.user.id,title:"",description:"",currency:"HKD",startingPrice:"",auctionStart:"",auctionEnd:""}),c=B(null),S=()=>{if(c.value){if(!l.title||!l.startingPrice||!l.auctionStart||!l.auctionEnd){_.error("Please fill in all required fields");return}c.value.submit()}},v=async y=>{const{file:e,onSuccess:d,onError:s}=y;try{const r=new FormData;r.append("image",e);const u={sellerId:l.sellerId,title:l.title,description:l.description,currency:l.currency,startingPrice:Number(l.startingPrice),auctionStart:new Date(l.auctionStart).toISOString(),auctionEnd:new Date(l.auctionEnd).toISOString()};r.append("request",new Blob([JSON.stringify(u)],{type:"application/json"}));const p=await I.post("/items",r,{headers:{"Content-Type":"multipart/form-data","auction-token":V}});_.success("Item created successfully!"),d?.(p)}catch(r){_.error(r?.response?.data?.message||"Upload failed"),s?.(r)}};return(y,e)=>{const d=a("el-input"),s=a("el-form-item"),r=a("el-date-picker"),u=a("el-option"),p=a("el-select"),b=a("el-col"),w=a("el-row"),C=a("upload-filled"),k=a("el-icon"),E=a("el-upload"),g=a("el-button"),U=a("el-form"),D=a("el-card");return T(),q("div",K,[t(D,{class:"auction-card",shadow:"hover"},{default:o(()=>[e[11]||(e[11]=i("h1",{class:"auction-title"},"Create Auction Item",-1)),e[12]||(e[12]=i("hr",{class:"title-divider"},null,-1)),t(U,{model:l,"label-width":"140px",class:"auction-form"},{default:o(()=>[t(s,{label:"Title"},{default:o(()=>[t(d,{modelValue:l.title,"onUpdate:modelValue":e[0]||(e[0]=n=>l.title=n),placeholder:"Enter item title"},null,8,["modelValue"])]),_:1}),t(s,{label:"Auction Time"},{default:o(()=>[i("div",O,[t(r,{modelValue:l.auctionStart,"onUpdate:modelValue":e[1]||(e[1]=n=>l.auctionStart=n),type:"datetime",placeholder:"Start date & time",class:"date-picker"},null,8,["modelValue"]),e[6]||(e[6]=i("span",{class:"date-separator"},"to",-1)),t(r,{modelValue:l.auctionEnd,"onUpdate:modelValue":e[2]||(e[2]=n=>l.auctionEnd=n),type:"datetime",placeholder:"End date & time",class:"date-picker"},null,8,["modelValue"])])]),_:1}),t(w,{gutter:20},{default:o(()=>[t(b,{span:12},{default:o(()=>[t(s,{label:"Currency"},{default:o(()=>[t(p,{modelValue:l.currency,"onUpdate:modelValue":e[3]||(e[3]=n=>l.currency=n),style:{width:"100%"}},{default:o(()=>[t(u,{label:"HKD",value:"HKD"}),t(u,{label:"USD",value:"USD"}),t(u,{label:"CNY",value:"CNY"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(b,{span:12},{default:o(()=>[t(s,{label:"Starting Price"},{default:o(()=>[t(d,{modelValue:l.startingPrice,"onUpdate:modelValue":e[4]||(e[4]=n=>l.startingPrice=n),type:"number",placeholder:"e.g. 100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(s,{label:"Description"},{default:o(()=>[t(d,{modelValue:l.description,"onUpdate:modelValue":e[5]||(e[5]=n=>l.description=n),type:"textarea",rows:"4",placeholder:"Describe the item..."},null,8,["modelValue"])]),_:1}),t(s,{label:"Image"},{default:o(()=>[t(E,{ref_key:"uploadRef",ref:c,drag:"","http-request":v,limit:1,"auto-upload":!1,multiple:!1,class:"upload-box"},{tip:o(()=>[...e[7]||(e[7]=[i("div",{class:"el-upload__tip"},"jpg/png only, max 16MB",-1)])]),default:o(()=>[t(k,{class:"upload-icon"},{default:o(()=>[t(C)]),_:1}),e[8]||(e[8]=i("div",{class:"upload-text"},[m("Drag image here or "),i("em",null,"click to upload")],-1))]),_:1},512)]),_:1}),i("div",j,[t(g,null,{default:o(()=>[...e[9]||(e[9]=[m("Cancel",-1)])]),_:1}),t(g,{type:"primary",onClick:S},{default:o(()=>[...e[10]||(e[10]=[m("Create",-1)])]),_:1})])]),_:1},8,["model"])]),_:1})])}}}),F=H(A,[["__scopeId","data-v-9b1e0219"]]);export{F as default};
